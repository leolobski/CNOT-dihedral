# A Finite Presentation of CNOT-Dihedral Operators
<!-- ideas for the title: Normalising quantum circuits / Towards simplification of quantum circuits -->
*guest post by [Giovanni De Felice](author1’s url) and [Leo Lobski](author2’s website)*

We begin the [Applied Category Theory School](http://www.appliedcategorytheory.org/adjoint-school-act-2019/) with a discussion inspired by the paper [A Finite Presentation of CNOT-Dihedral Operators](https://arxiv.org/abs/1701.00140) by Matthew Amy, Jianxin Chen and Niel J. Ross. The result of the paper, existence and uniqueness of a normal form for a fragment of quantum computation, was obtained by the authors observing an interesting interplay between two languages: on one hand we have the representation of quantum gates as circuits in a symmetric monoidal category (which is moreover a groupoid in this case), and on the other hand we can view the diagonal gates as 'phase polynomials'. When trying to understand a new field, subject or theory, it is often useful to view it from as many angles as possible. In mathematics, this involves studying various representations of an object. In this blog post, we thus add a third language to the ones introduced in the paper, the ZX-calculus. This, inter alia, serves the purpose of putting the work done in the paper into a broader context, as the ZX-calculus is already implicit in the monoidal circuit representation; indeed, all the relations that hold for the gates in the paper are derivable in the ZX-calculus.

## Introduction

Algebraic theory of quantum circuits: logical vs reversible gates.
Logical gates (linear maps) have been axiomatised in the ZX and ZW calculi, these form compact closed monoidal categories.
An axiomatisation of unitary circuits, in the form of a symmetric monoidal groupoid, is a harder task. The circuit model for quantum computation is based on the universal set of unitaries $CNOT, X, T, H$, generating the Clifford+T gate set. Universality here means that we can get arbitrarily close to any $n$-qubit unitary using polynomially many gates.

Algebraic theories for restricted fragments:
* Lafont (2003): affine circuits $CNOT, X$
* Selinger (2015): clifford groupoid $CNOT, X, H, T^2$

Clifford gates are efficiently classically simulatable, the $T$-gate gives universality but is a hard gate to implement in a lab, look for ways of reducing $T$-count.

* May et al. (2013, 2016): phase polynomials for $T$-count optimization in the $CNOT, T$ fragment.

In this paper the focus is on CNOT-Dihedral gates, i.e. generated by $CNOT, X, T$. It offers a confluence of strategies: groupoid, universal algebra, phase polynomials.

## Brief overview of the paper

The paper proves existence and uniqueness of a normal for the CNOT-dihedral operators, which are defined below [Amy, Chen and Ross. p.86].

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/CNOT-gates.png"
alt = ""/>

An important step is the observation that the operators can be split into two classes: diagonal gates and affine gates. The diagonal gates have a diagonal matrix representations, while the affine ones are affine transformations of the basis states. The gates $X$, $CNOT$ and $SWAP$ are affine, while $\omega$, $T$, $U$ and $V$ are diagonal. Those CNOT-dihedral circuits that only conṭain affine gates are called affine circuits, and correspondingly for diagonal circuits.

The gates are subject to the following relations. [Amy, Chen and Ross. p.87].

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/relations.png"
alt = ""/>

One central point to notice here are the *degree reduction* rules $R_1$, $R_4$, $R_7$, $R_8$, $R_9$ and $R_10$, which yield an upper bound on the power of each gate in the normal form. The degree reduction rules also have a direct interpretation in terms of phase polynomial equalities. We will discuss the phase polynomial representation in more detail in the third section. All of these relations are derivable in the ZX-calculus, making the CNOT-dihedral gates a proper fragment thereof.

The normal forms for affine and diagonal circuits turn out to be different, and the overall normal form is a combination of the two. In fact existence and uniqueness of the normal form for affine gates was already proved by [Lafont](http://iml.univ-mrs.fr/~lafont/pub/circuits.pdf). Thus, what is proved in the present paper is that
* if an affine gate is to the left of a diagonal gate, the circuit can be rewritten in such a way that the affine gate is the rightmost gate and all the remaining gates are diagonal (i.e. affine gates 'commute' past the diagonal ones),
* diagonal gates commute with diagonal gates,
* any diagonal circuit has a unique normal form.

It then follows that any CNOT-dihedral circuit $C$ can be rearranged so that $C=DA$, where $D$ is a diagonal circuit and $A$ an affine one. Then one can just apply the result of Lafont to $A$ and the last bullet point above to $D$ to get that $C$ has a unique normal form.

The diagonal normal form they provide is given by an ordering of the diagonal gates, together with bounds on the number of consecutive gates used, which comes from their representation in terms of phase polynomials.

<!-- The first step towards a normal form is to show that the gates $\omega, T, U, V$ generate all diagonal gates in the fragment. They give a small number of relations on these generators which allow to show that they commute with affine gates and between themselves. -->


### From ZX to CNOT-Dihedral rules

In order to get an intuition for the presentation given in the paper, we make a short digression to briefly introduce some of the ZX-calculus rules. This will allow us to understand the rules exposed in the paper as direct consequences of the underlying rules for logical gates (linear maps) modelled with the ZX-calculus. It will also highlight the rules which are not directly derivable from ZX, which we will see come from the phase polynomial formalism.

The ZX calculus is based on (strongly) complementary bases, roughly meaning that measurements cannot be performed simultaneously in both bases. The generators (processes or measurements) in these bases are denoted by dots of different colour, traditionally red and green, decorated with a phase. The generators (known as *spiders* or dagger special Frobenius algebras)

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/ZX-generators.png"
alt = ""/>

with $n$ inputs and $m$ outputs (the diagrams are read from left to right) correspond to linear maps

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/linearmaps.png"
alt = ""/>

where $|\plusminus\rangle = \frac{1}{\sqrt 2}(|0\rangle \plusminus |1\rangle)$ and $\alpha\in(-\pi,\pi]$ (see e.g. [Backens](https://arxiv.org/abs/1307.7025)). The rule governing the interaction between generators of the same colour is the *spider fusion law* (a consequence of the axioms of dagger special Frobenius algebras), which states that spiders of the same colour can fuse into each other and their phases add up (modulo $2\pi$).

The basic rules encoding strong complementarity are the bialgebra and Hopf laws.

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/hopf-bialgebra.png"
alt = ""/>

The CNOT-dihedral fragment can be modelled in ZX, it is given by the following representations of the generators.

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/CNOT-generators.png"
alt = ""/>

This can then be used to obtain the representations for the derived generators.

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/CNOT-derived.png"
alt = ""/>


Most of the relations $R_1$ to $R_13$ can be derived using the spider fusion law, the Hopf law and the bialgebra law.


## Phase polynomials

The phase polynomial representation of diagonal gates.̣̣

reading the phase polynomial from a circuit: understanding rule 9.

Diagonal normal form from phase polynomials

Degree reductions and uniqueness.

## Diagonal gates in ZX: reducing $T$-count with the ZX-calculus.

<img width = "100" src = "https://raw.githubusercontent.com/leolobski/CNOT-dihedral/master/assets/R13.png"
alt = ""/>

## Future work
